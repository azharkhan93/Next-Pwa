
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Role {
  superAdmin
  admin
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  email     String   @unique
  password  String
  role      Role     @default(superAdmin)
}

model Record {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  consumerId String   @unique
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  // Farmer Details
  name      String
  parentage String?
  address   String?
  district  String?
  pinCode   String?
  phoneNo   String?
  adharNo   String?
  khasraNo  String?
  latitude  String?
  longitude String?
  location  String?
  city      String?
  stateVal  String?

  // Farm Details
  crop                String?
  cropOther           String?
  variety             String?
  plantationType      String?
  plantationTypeOther String?
  age                 Float?
  noTrees             Float?
  area                Float?
  noOfSamples         Float?
  soilDepth           String?
  soilType            String?
  soilTypeOther       String?
  drainage            String?
  drainageOther       String?
  irrigationMethod    String?
  irrigationMethodOther String?
  paramPh             Boolean? @default(false)
  paramDl             Boolean? @default(false)
  paramCl             Boolean? @default(false)
  parameterPrice      Float?
  paymentStatus       String?
  paymentDate         DateTime?
  paidAmount          Float?

  // Legacy single test result fields (for backward compatibility)
  ph                  String?
  organicCarbon       String?
  nitrogen            String?
  phosphorus          String?
  potassium           String?
  calcium             String?
  magnesium           String?
  nitrogenRating      String?
  phosphorusRating    String?
  potassiumRating     String?

  // Multiple test results (array of embedded documents as JSON)
  // Each test result contains: id, labTestNo, ph, bufferPh, organicCarbon, 
  // Primary Macronutrients: nitrogen, phosphorus, potassium
  // Secondary Macronutrients: calcium, magnesium, sulfur
  // Micronutrients: iron, manganese, zinc, copper, boron, molybdenum, chlorine, nickel
  // Other: sodium, electricalConductivity, solubleSalts
  // Ratings: phRating, organicCarbonRating, nitrogenRating, phosphorusRating, potassiumRating
  // Recommendations (calculated on backend): nitrogenRecommendation, phosphorusRecommendation, potassiumRecommendation
  // Each recommendation contains: { level, increasePercent, suggestion }
  testResults         Json? @default("[]")
}

